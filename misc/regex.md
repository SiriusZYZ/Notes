# 正则表达式简介

正则表达式(Regular Expression, regex)是一种文本模式，可以用于描述或匹配字符串的特定模式(pattern)

# regex的模式

模式是指一种字符的组合方式，比如4个数字字符的模式可以被`0123` 匹配。

regex模式的表示方式也是一组字符串，可以包含：
- 字符的字面值：包括字母、数字、空格、连字符`-_`，可以直接匹配到本身
- 字符集合：`[]` 方括号内包含一系列字符的字面值，用于匹配其中的任意一个字符
- 元字符：`\d`, `\w`, `\s` 用于匹配特定字符，如数字、字母、空白字符等
- 特殊字符：`.*+?` 等将被转义，包含特殊意义及功能
- 量词：`{n}, {n,}, {n, m}`指定匹配左边的模式多少次
- 边界符号：`^$\b\B` 用于匹配字符串的开头、结尾或单次边界位置

regex的模式在各环境的支持性

| **命令或环境**      | **.** | **[ ]** | **^** | **$** | **\\( \\)** | **\\{ \\}** | **?** | **+** | **\|** | **( )** |
| -------------- | ----- | ------- | ----- | ----- | ----------- | ----------- | ----- | ----- | ------ | ------- |
| **vi**         | √     | √       | √     | √     | √           |             |       |       |        |         |
| **Visual C++** | √     | √       | √     | √     | √           |             |       |       |        |         |
| **awk**        | √     | √       | √     | √     |             | √*          | √     | √     | √      | √       |
| **sed**        | √     | √       | √     | √     | √           | √           |       |       |        |         |
| **delphi**     | √     | √       | √     | √     | √           |             | √     | √     | √      | √       |
| **python**     | √     | √       | √     | √     | √           | √           | √     | √     | √      | √       |
| **java**       | √     | √       | √     | √     | √           | √           | √     | √     | √      | √       |
| **javascript** | √     | √       | √     | √     | √           |             | √     | √     | √      | √       |
| **php**        | √     | √       | √     | √     | √           |             |       |       |        |         |
| **perl**       | √     | √       | √     | √     | √           |             | √     | √     | √      | √       |
| **C#**         | √     | √       | √     | √     |             |             | √     | √     | √      | √       |
\* 支持，但要命令行加入 `--posix`或` --re-interval`，见man awk中的interval expression

# regex的语法

## 单个普通字符

`c`: 模式为匹配单个字符"c":
```python
>>> re.findall(r"o", "google")
['o', 'o']
```

## 字符集合

`[]` 用于表示一个字符集合，用于匹配方括号内的任意一个字符
1.  通常，可以单个单个列出，比如`[aeiou]`
```python
>>> re.findall(r"[aeiou]", "google apple microsoft")
['o', 'o', 'e', 'a', 'e', 'i', 'o', 'o']
```
2. 也可以使用连词符号表示一系列范围，如`[a-g4-7]`，不必要是`a-zA-Z` 等完整的列表
```python
>>> re.findall(r"[a-gw-z]", "google apple microsoft")
['g', 'g', 'e', 'a', 'e', 'c', 'f']
```
3. 当字符集合首个字符是`^` 时，表示对集合取反，即匹配不在方括号内的任意字符
```python
>>> re.findall(r"[^aeiou]", "google apple microsoft")
['g', 'g', 'l', ' ', 'p', 'p', 'l', ' ', 'm', 'c', 'r', 's', 'f', 't']
```

## 元字符

### 匹配一组字符

| 字符   | 等价              | 描述                       |
| ---- | --------------- | ------------------------ |
| `.`  | `[^\n\r]`       | 匹配除换行外的所有字符，特殊模式下可以包含换行符 |
| `\d` | `[0-9]`         | 匹配十进制数字`0-9`             |
| `\D` | `[^0-9]`        | 匹配不属于十进制数的任意字符           |
| `\w` | `[a-zA-z0-9_]`  | 匹配单词类字符所有大小写拉丁字母，数字及下划线  |
| `\W` | `[^a-zA-z0-9_]` | 匹配非单词类字符                 |
```python
>>> re.findall(r".", "1:google 2:apple")
['1', ':', 'g', 'o', 'o', 'g', 'l', 'e', ' ', '2', ':', 'a', 'p', 'p', 'l', 'e']
>>> re.findall(r"\d", "1:google 2:apple")
['1', '2']
>>> re.findall(r"\D", "1:google 2:apple")
[':', 'g', 'o', 'o', 'g', 'l', 'e', ' ', ':', 'a', 'p', 'p', 'l', 'e']
```

### 匹配转义字符

### 匹配非打印字符

非打印字符包括了:
- 空格、回车、换行、换页、制表这些符号
- 还包括空字符

如下表所示，用得比较多的是`\s` 和`\S`，直观地说，`\s` 和`\S` 就是一对互斥集合

| 非打印字符 | 描述                                                                                    |
| ----- | ------------------------------------------------------------------------------------- |
| `\s`  | 匹配任何空白字符，包括空格、制表符、换页符等等。等价于` [ \f\n\r\t\v]`。注意 Unicode 正则表达式会匹配全角空格符。                 |
| `\S`  | 匹配任何非空白字符。等价于 `[^ \f\n\r\t\v]`                                                        |
| `\n`  | 匹配一个换行符。等价于` \x0a `和` \cJ`。                                                           |
| `\r`  | 匹配一个回车符。等价于 `\x0d `和 `\cM`。                                                           |
| `\t`  | 匹配一个制表符。等价于 \x09 和 \cI。                                                               |
| `\v`  | 匹配一个垂直制表符。等价于 \x0b 和 \cK。                                                             |
| `\cx` | 匹配由x指明的控制字符。例如， `\cM `匹配一个 Control-M 或回车符。x 的值必须为 A-Z 或 a-z 之一。否则，将 c 视为一个原义的 'c' 字符。 |
| `\f`  | 匹配一个换页符。等价于 `\x0c `和` \cL`。                                                           |

### 匹配特定位置